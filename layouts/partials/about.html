{{ $contextType := printf "%T" . }}
{{ $isShortcode := (eq $contextType "*hugolib.ShortcodeWithPage") }}

<section id="about" class="section rad-animation-group pb-0">
  <div class="container rad-fade-down">
    <div class="row d-flex flex-column-reverse flex-md-row">
      <div class="about__profile-picture col-12 col-md-6">
        {{/* Use cond to pick which value to use for the images */}}
        {{ $imgXParam := cond $isShortcode ( .Get "image" | default .Site.Data.homepage.about.image.x ) .Site.Data.homepage.about.image.x }}
        {{ $img2xParam := cond $isShortcode ( .Get "image2x" | default .Site.Data.homepage.about.image._2x ) .Site.Data.homepage.about.image._2x }}

        {{ warnf "about.html: Image x: %q" $imgXParam }}
        {{ warnf "about.html: Image 2x: %q" $img2xParam }}

        {{ $img := resources.Get $imgXParam }}
        {{ $img2x := resources.Get $img2xParam }}

        {{ with $img }}
          {{ with $img2x }}
            {{ $imgWebp := .Resize (printf "%dx%d webp" .Width .Height) }}
            {{ $img2xWebp := .Resize (printf "%dx%d webp" $img2x.Width $img2x.Height) }}
            <picture>
              <source srcset="{{ $imgWebp.RelPermalink }} 1x, {{ $img2xWebp.RelPermalink }} 2x" type="image/webp" />
              <source srcset="{{ $img.RelPermalink }} 1x, {{ $img2x.RelPermalink }} 2x" type="image/webp">
              <img
                width="{{ $img.Width }}"
                height="{{ $img.Height }}"
                class="lozad img-responsive image-left-overflow"
                src="data:image/gif;base64,R0lGODlhBwACAIAAAP///wAAACH5BAEAAAEALAAAAAAHAAIAAAIDjI9YADs="
                srcset="{{ $img.RelPermalink }} 1x, {{ $img2x.RelPermalink }} 2x"
                data-src="{{ $img.RelPermalink }}"
                data-srcset="{{ $img.RelPermalink }} 1x, {{ $img2x.RelPermalink }} 2x"
                alt='{{ i18n "about_image_alt" }}'
              />
            </picture>
          {{ else }}
            {{ warnf "about.html: 2x image not found: %q" $img2xParam }}
          {{ end }}
        {{ else }}
          {{ warnf "about.html: Image not found: %q" $imgXParam }}
        {{ end }}
      </div>
      <div class="col-12 col-md-6 my-auto my-auto">
        <h2>
          {{ if $isShortcode }}
            {{ .Get "title" | default (i18n "about_title") }}
          {{ else }}
            {{ i18n "about_title" }}
          {{ end }}
        </h2>
        <div class="about-me content lead">
          {{ if $isShortcode }}
            {{ .Get "content" | default (i18n "about_content") | safeHTML }}
          {{ else }}
            {{ i18n "about_content" | safeHTML }}
          {{ end }}
        </div>
        <a
          href="{{ if $isShortcode }}{{ .Get "button_url" | default (.Site.Data.homepage.about.button.URL | absURL) }}{{ else }}{{ .Site.Data.homepage.about.button.URL | absURL }}{{ end }}"
          target="_blank"
          class="btn btn-primary"
        >
          <i class="{{ if $isShortcode }}{{ .Get "button_icon" | default .Site.Data.homepage.about.button.icon }}{{ else }}{{ .Site.Data.homepage.about.button.icon }}{{ end }}"></i>
          {{ if $isShortcode }}
            {{ .Get "button_text" | default (i18n "about_button") }}
          {{ else }}
            {{ i18n "about_button" }}
          {{ end }}
        </a>
      </div>
    </div>
  </div>
</section>